{"ast":null,"code":"import React,{useRef,useState}from'react';import'./TreinoVisual.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LOGO_FILENAME='Rodolfo_Logo.png';const TreinoVisual=_ref=>{let{lista,alunoNome,observacoes,onClose,isModoVisualizacao}=_ref;const treinoRef=useRef();const[textoBotao,setTextoBotao]=useState('Exportar Planilha Animada');// Função auxiliar para converter um arquivo para Base64\nconst toBase64=blob=>new Promise((resolve,reject)=>{const reader=new FileReader();reader.readAsDataURL(blob);reader.onload=()=>resolve(reader.result);reader.onerror=error=>reject(error);});const handleExportHTML=async()=>{setTextoBotao('Exportando...');if(!treinoRef.current){setTextoBotao('Exportar Planilha Animada');return;}try{// 1. Clona o elemento do treino para não modificar a tela\nconst clone=treinoRef.current.cloneNode(true);const images=clone.querySelectorAll('img');// 2. Itera sobre cada imagem (GIFs e Logo) e a embuti no HTML\nfor(const img of images){const src=img.getAttribute('src');try{const response=await fetch(src);const blob=await response.blob();img.src=await toBase64(blob);// Substitui o link pela imagem embutida\n}catch(error){console.error('Falha ao embutir imagem:',src,error);}}// 3. Pega todo o CSS da página\nconst cssContent=Array.from(document.styleSheets).map(sheet=>{try{return Array.from(sheet.cssRules).map(rule=>rule.cssText).join('');}catch(e){return'';}}).join('');// 4. Monta o arquivo HTML final\nconst htmlString=\"\\n                <!DOCTYPE html>\\n                <html lang=\\\"pt-BR\\\">\\n                <head>\\n                    <meta charset=\\\"UTF-8\\\">\\n                    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n                    <title>Treino - \".concat(alunoNome,\"</title>\\n                    <style>\").concat(cssContent,\"</style>\\n                </head>\\n                <body>\\n                    \").concat(clone.outerHTML,\"\\n                </body>\\n                </html>\\n            \");// 5. Gera o link para download\nconst blob=new Blob([htmlString],{type:'text/html'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=\"treino-\".concat(alunoNome.replace(/ /g,'_')||'aluno',\".html\");document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);setTextoBotao('✅ Exportado!');setTimeout(()=>setTextoBotao('Exportar Planilha Animada'),2500);}catch(error){console.error(\"Erro ao gerar o HTML:\",error);alert(\"Ocorreu um erro ao gerar o arquivo.\");setTextoBotao('Exportar Planilha Animada');}};// O resto do componente não muda\nif(isModoVisualizacao){return/*#__PURE__*/_jsx(\"div\",{ref:treinoRef,className:\"container-treino\",children:\" ... \"});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Pr\\xE9-visualiza\\xE7\\xE3o do Treino\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"close-button\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-actions\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleExportHTML,className:\"export-button\",children:textoBotao})}),/*#__PURE__*/_jsxs(\"div\",{ref:treinoRef,className:\"container-treino\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"cabecalho-treino-novo\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cabecalho-texto\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Rodolfo Ferraz\"}),/*#__PURE__*/_jsx(\"p\",{className:\"subtitulo-personal\",children:\"Personal Trainer\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"nome-aluno\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Aluno(a):\"}),\" \",alunoNome||'____________________']})]}),/*#__PURE__*/_jsx(\"div\",{className:\"cabecalho-logo\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/\".concat(LOGO_FILENAME),alt:\"Logo Personal Trainer\",className:\"logo-img\"})})]}),/*#__PURE__*/_jsx(\"main\",{className:\"grid-exercicios\",children:lista.slice(0,9).map((ex,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"card-exercicio\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"numero-exercicio\",children:index+1}),/*#__PURE__*/_jsx(\"img\",{src:\"/gifs/\".concat(ex.gif),alt:ex.nome,className:\"gif-exercicio\"}),/*#__PURE__*/_jsx(\"p\",{className:\"nome-exercicio\",children:/*#__PURE__*/_jsx(\"strong\",{children:ex.nome})}),/*#__PURE__*/_jsx(\"p\",{className:\"serie-exercicio\",children:\"3x10 rep\"})]},index))}),/*#__PURE__*/_jsxs(\"footer\",{className:\"rodape-treino-novo\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Observa\\xE7\\xF5es:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"observacoes-texto\",children:observacoes||'Nenhuma.'})]})]})]});};export default TreinoVisual;","map":{"version":3,"names":["React","useRef","useState","jsx","_jsx","jsxs","_jsxs","LOGO_FILENAME","TreinoVisual","_ref","lista","alunoNome","observacoes","onClose","isModoVisualizacao","treinoRef","textoBotao","setTextoBotao","toBase64","blob","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","handleExportHTML","current","clone","cloneNode","images","querySelectorAll","img","src","getAttribute","response","fetch","console","cssContent","Array","from","document","styleSheets","map","sheet","cssRules","rule","cssText","join","e","htmlString","concat","outerHTML","Blob","type","url","URL","createObjectURL","a","createElement","href","download","replace","body","appendChild","click","removeChild","revokeObjectURL","setTimeout","alert","ref","className","children","onClick","alt","slice","ex","index","gif","nome"],"sources":["/Users/rodolfoferraz/Desktop/meu-treino-app/frontend/src/TreinoVisual.js"],"sourcesContent":["import React, { useRef, useState } from 'react';\nimport './TreinoVisual.css';\n\nconst LOGO_FILENAME = 'Rodolfo_Logo.png'; \n\nconst TreinoVisual = ({ lista, alunoNome, observacoes, onClose, isModoVisualizacao }) => {\n    const treinoRef = useRef();\n    const [textoBotao, setTextoBotao] = useState('Exportar Planilha Animada');\n\n    // Função auxiliar para converter um arquivo para Base64\n    const toBase64 = blob => new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.readAsDataURL(blob);\n        reader.onload = () => resolve(reader.result);\n        reader.onerror = error => reject(error);\n    });\n\n    const handleExportHTML = async () => {\n        setTextoBotao('Exportando...');\n        if (!treinoRef.current) {\n            setTextoBotao('Exportar Planilha Animada');\n            return;\n        }\n\n        try {\n            // 1. Clona o elemento do treino para não modificar a tela\n            const clone = treinoRef.current.cloneNode(true);\n            const images = clone.querySelectorAll('img');\n\n            // 2. Itera sobre cada imagem (GIFs e Logo) e a embuti no HTML\n            for (const img of images) {\n                const src = img.getAttribute('src');\n                try {\n                    const response = await fetch(src);\n                    const blob = await response.blob();\n                    img.src = await toBase64(blob); // Substitui o link pela imagem embutida\n                } catch (error) {\n                    console.error('Falha ao embutir imagem:', src, error);\n                }\n            }\n\n            // 3. Pega todo o CSS da página\n            const cssContent = Array.from(document.styleSheets)\n                .map(sheet => {\n                    try { return Array.from(sheet.cssRules).map(rule => rule.cssText).join(''); } \n                    catch (e) { return ''; }\n                })\n                .join('');\n\n            // 4. Monta o arquivo HTML final\n            const htmlString = `\n                <!DOCTYPE html>\n                <html lang=\"pt-BR\">\n                <head>\n                    <meta charset=\"UTF-8\">\n                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                    <title>Treino - ${alunoNome}</title>\n                    <style>${cssContent}</style>\n                </head>\n                <body>\n                    ${clone.outerHTML}\n                </body>\n                </html>\n            `;\n\n            // 5. Gera o link para download\n            const blob = new Blob([htmlString], { type: 'text/html' });\n            const url = URL.createObjectURL(blob);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = `treino-${alunoNome.replace(/ /g, '_') || 'aluno'}.html`;\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n\n            setTextoBotao('✅ Exportado!');\n            setTimeout(() => setTextoBotao('Exportar Planilha Animada'), 2500);\n\n        } catch (error) {\n            console.error(\"Erro ao gerar o HTML:\", error);\n            alert(\"Ocorreu um erro ao gerar o arquivo.\");\n            setTextoBotao('Exportar Planilha Animada');\n        }\n    };\n    \n    // O resto do componente não muda\n    if (isModoVisualizacao) { return ( <div ref={treinoRef} className=\"container-treino\"> ... </div> ) }\n\n    return (\n        <div>\n            <div className=\"modal-header\">\n                <h2>Pré-visualização do Treino</h2>\n                <button onClick={onClose} className=\"close-button\">&times;</button>\n            </div>\n            <div className=\"modal-actions\">\n                <button onClick={handleExportHTML} className=\"export-button\">\n                    {textoBotao}\n                </button>\n            </div>\n            <div ref={treinoRef} className=\"container-treino\">\n                <header className=\"cabecalho-treino-novo\">\n                    <div className=\"cabecalho-texto\">\n                      <h2>Rodolfo Ferraz</h2>\n                      <p className=\"subtitulo-personal\">Personal Trainer</p>\n                      <p className=\"nome-aluno\"><strong>Aluno(a):</strong> {alunoNome || '____________________'}</p>\n                    </div>\n                    <div className=\"cabecalho-logo\">\n                        <img src={`/${LOGO_FILENAME}`} alt=\"Logo Personal Trainer\" className=\"logo-img\" />\n                    </div>\n                </header>\n                <main className=\"grid-exercicios\">\n                    {lista.slice(0, 9).map((ex, index) => (\n                        <div key={index} className=\"card-exercicio\">\n                            <span className=\"numero-exercicio\">{index + 1}</span>\n                            <img src={`/gifs/${ex.gif}`} alt={ex.nome} className=\"gif-exercicio\" />\n                            <p className=\"nome-exercicio\"><strong>{ex.nome}</strong></p>\n                            <p className=\"serie-exercicio\">3x10 rep</p>\n                        </div>\n                    ))}\n                </main>\n                <footer className=\"rodape-treino-novo\">\n                    <h3>Observações:</h3>\n                    <p className=\"observacoes-texto\">{observacoes || 'Nenhuma.'}</p>\n                </footer>\n            </div>\n        </div>\n    );\n};\nexport default TreinoVisual;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}